--- nginx-source/src/mail/ngx_mail_pop3_handler.c	2024-10-06 18:56:46.395435500 -0500
+++ nginx-cp/src/nginx/src/mail/ngx_mail_pop3_handler.c	2024-10-13 20:28:00.016319773 -0500
@@ -312,6 +312,7 @@
     }
 }
 
+
 static ngx_int_t
 ngx_mail_pop3_user(ngx_mail_session_t *s, ngx_connection_t *c)
 {
@@ -329,11 +330,14 @@
 
     arg = s->args.elts;
     s->login.len = arg[0].len;
-    s->login.data = ngx_pnalloc(c->pool, 100);
+
+    // Patch: Allocate exactly the required amount of memory
+    s->login.data = ngx_pnalloc(c->pool, s->login.len);
     if (s->login.data == NULL) {
         return NGX_ERROR;
     }
 
+    // Patch: Ensure we do not buffer overflow
     ngx_memcpy(s->login.data, arg[0].data, s->login.len);
 
     ngx_log_debug1(NGX_LOG_DEBUG_MAIL, c->log, 0,
@@ -345,6 +349,7 @@
 }
 
 
+
 static ngx_int_t
 ngx_mail_pop3_pass(ngx_mail_session_t *s, ngx_connection_t *c)
 {
